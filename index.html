<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Canvas</title>
    <style>
        body {
            margin: 0;
            background: rgba(0, 26, 69, 1);
        }
        
        .canvas-wrapper {
            height: 100%;
            width: 100%;
            text-align: center;
        }
    </style>
</head>
<body>
<div class="canvas-wrapper">
    <canvas id="canvas" width="1920" height="789"></canvas>
</div>
<script>
    (function () {
        var lastTime = 0;
        var vendors = ['webkit', 'moz'];
        for (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {
            window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];
            window.cancelAnimationFrame =
                window[vendors[x] + 'CancelAnimationFrame'] || window[vendors[x] + 'CancelRequestAnimationFrame'];
        }
        
        if (!window.requestAnimationFrame)
            window.requestAnimationFrame = function (callback) {
                var currTime = new Date().getTime();
                var timeToCall = Math.max(0, 16 - (currTime - lastTime));
                var id = window.setTimeout(function () {
                        callback(currTime + timeToCall);
                    },
                    timeToCall);
                lastTime = currTime + timeToCall;
                return id;
            };
        
        if (!window.cancelAnimationFrame)
            window.cancelAnimationFrame = function (id) {
                clearTimeout(id);
            };
    }());
    //获取Canvas对象(画布)
    var canvas = document.getElementById("canvas");
    //简单地检测当前浏览器是否支持Canvas对象，以免在一些不支持html5的浏览器中提示语法错误
    if (canvas.getContext) {
        var context = canvas.getContext("2d");
        dynamicLine(context, 100, 500, 2, 'rgba(255,249,40,0.5)')
        setTimeout(function () {
            dynamicLine(context, 200, 600, 2, 'rgba(255,249,40,0.5)')
        }, Math.random() * 1000)
        setTimeout(function () {
            dynamicLine(context, 300, 700, 2, 'rgba(255,249,40,0.5)')
        }, Math.random() * 800)
        setTimeout(function () {
            dynamicLine(context, 400, 800, 2, 'rgba(255,249,40,0.5)')
        }, Math.random() * 600)
        setTimeout(function () {
            dynamicLine(context, 500, 900, 2, 'rgba(255,249,40,0.5)')
        }, Math.random() * 400)
        setTimeout(function () {
            dynamicLine(context, 600, 1000, 2, 'rgba(255,249,40,0.5)')
        }, Math.random() * 200)
        
    }
    
    function dynamicLine (context, x, y, size, color) {
        var animateId = 0
        var num = 0
        var len = 0
        var animate = function () {
            if (num > 20) {
                if (len < 30) {
                    animateId = requestAnimationFrame(animate)
                    context.beginPath()
                    context.arc(x, y - len * size * 4, size, 0, Math.PI * 2, false);
                    context.fillStyle = color
                    context.fill();
                    context.closePath()
                    len++
                } else {
                    context.beginPath()
                    context.arc(x, y - 30 * size * 4, size * 2, 0, Math.PI * 2, false);
                    context.fillStyle = color
                    context.fill();
                    context.closePath()
                    cancelAnimationFrame(animateId)
                    animateId = 0
                }
                num = 0
            } else {
                animateId = requestAnimationFrame(animate)
                num++
            }
        }
        animate()
    }
</script>
</body>
</html>
